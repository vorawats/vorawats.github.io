grecaptcha.ready(()=>{grecaptcha.execute('6LdQemQiAAAAAAgKpIXZjs_sEfXSGaQRgrdkU4mu',{action:'contact'}).then(token=>{document.querySelector('#recaptcha').value=token;});});const onloadCallback=function(){grecaptcha.ready(()=>{grecaptcha.execute('6LdQemQiAAAAAAgKpIXZjs_sEfXSGaQRgrdkU4mu',{action:'contact'}).then(token=>{document.querySelector('#recaptcha').value=token;});});};var current_fs,next_fs,previous_fs;var left,opacity,scale;var animating;$(`#submitCheckBank`).click(function(){let accnum=$(`#accnum`).val();let bankid=$(`#bank`).val();let recaptcha=$(`#recaptcha`).val();if(accnum==''){return alert('กรุณากรอก เลขบัญชี');}
$(`#submitCheckBank`).html('<i class="fa fa-spinner fa-spin"></i>');$(`#submitCheckBank`).prop("disabled",true);onloadCallback()
$.ajax({url:"/account/register/checkBankAccount",type:"POST",dataType:'json',data:{accnum,bankid,recaptcha},}).done(function(res){if(res.status==200){if(animating){return false;}
$(`#fullname`).val(res.account)
animating=true;current_fs=$('#submitCheckBank').parent();next_fs=$('#submitCheckBank').parent().next();next_fs.show();current_fs.animate({opacity:0},{step:function(now,mx){scale=1-(1-now)*0.2;left=(now*50)+"%";opacity=1-now;current_fs.css({'transform':'scale('+scale+')','position':'absolute'});next_fs.css({'left':left,'opacity':opacity});},duration:800,complete:function(){current_fs.hide();animating=false;},});}else{alert(res.message);}
$(`#submitCheckBank`).prop("disabled",false);$(`#submitCheckBank`).html('ยืนยัน');}).fail(function(err){alert('กรุณาลองทำรายการใหม่อีกครั้ง');location.reload();});})
function register(){var known=$("#known").val();var phone=$("#phone").val();var password=$("#password").val();var fullname=$("#fullname").val();var bank=$("#bank").val();var accnum=$("#accnum").val();var refer_detail=$("#refer_detail").val();var promotion=$("#promotion").val();var recaptcha=$("#recaptcha").val();if(password.trim()==""){$("#password").focus();$("#notification").html('<div class="alert alert-warning" role="alert">กรุณากรอกรหัสผ่าน</div>');}
else if(fullname.trim()==""){$("#fullname").focus();$("#notification").html('<div class="alert alert-warning" role="alert">กรุณากรอกชื่อ-นามสกุล</div>');}else if(accnum.trim()==""){$("#accnum").focus();$("#notification").html('<div class="alert alert-warning" role="alert">กรุณากรอกเลขบัญชี</div>');}
else{$("#btn_register").attr("disabled",true);$("#btn_register").text("กำลังส่ง...");$("#btn_register").css("opacity","0.6");$("#notification").html('');$.post("/account/register/insert66",{known:known,phone:phone,password:password,fullname:fullname,bank:bank,accnum:accnum,refer_detail:refer_detail,promotion:promotion,recaptcha:recaptcha}).done(function(rsp){if(rsp.status==200){$("#btn_register").attr("disabled",false);$("#btn_register").text("สมัครสมาชิก");$("#btn_register").css("opacity","1");$("#notification").html(`<span style='color: lime;font-size: 18px;font-weight: 400;'><i class="fa fa-spinner fa-spin"></i> สมัครสำเร็จ : หน่วงเวลา 1 วินาทีเพื่อไปยังหน้าล็อคอิน</span>`);window.open('https://lin.ee/MmhBygc','_blank');var myVar=setInterval(myTimer,1000);}
else{onloadCallback()
$("#btn_register").attr("disabled",false);$("#btn_register").text("สมัครสมาชิก");$("#btn_register").css("opacity","1");$("#notification").html('<div class="alert alert-warning" role="alert">'+rsp.message+'</div>');}});}}
function myTimer(){window.location="/account";}